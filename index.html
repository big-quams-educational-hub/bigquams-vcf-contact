<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CampusConnect NG - Join Us</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --primary-blue: #007BFF;
      --secondary-orange: #FF8C00;
      --tertiary-green: #28A745; /* Green for success messages, WhatsApp links */
      --white-bg: #FFFFFF;
      --light-gray-bg: #F8F9FA;
      
      --text-color-dark: #212529;
      --text-color-light: #6C757D;
      --border-color: #CED4DA;
      
      --shadow-light: rgba(0,0,0,0.08);
      --shadow-medium: rgba(0,0,0,0.12);
      
      --success-bg: #D4EDDA;
      --success-border: #C3E6CB;
      --success-text: #155724;
      
      --whatsapp-color: #25D366; /* WhatsApp brand green */
      --whatsapp-dark-color: #1DA851; /* Darker green for hover */
    }

    body {
      font-family: 'Segoe UI', 'Roboto', sans-serif;
      background: var(--light-gray-bg);
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      color: var(--text-color-dark);
      line-height: 1.6;
    }

    /* Cover picture container */
    .cover-picture-container {
        width: 100%;
        height: 200px; /* Adjust height as needed */
        background-color: #ddd; /* Placeholder background */
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        margin-bottom: 30px;
        position: relative; /* Needed for absolute positioning of header elements */
        display: flex; /* To center content horizontally */
        justify-content: center; /* Center content horizontally */
        align-items: center; /* Center content vertically */
        box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        /* Your cover image URL: */
        background-image: url('https://ik.imagekit.io/bigquamsmedia/CampusConnect-NG-reduced.jpeg?updatedAt=1759624459929'); 
    }

    .header {
        position: absolute; /* Position over the cover image */
        top: 0;
        left: 0;
        width: 100%;
        background-color: rgba(0, 123, 255, 0.7); /* Semi-transparent blue */
        color: var(--white-bg);
        padding: 15px 0;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        display: flex; /* Use flexbox to align logo and title */
        align-items: center;
        justify-content: center; /* Initially center both */
        gap: 15px; /* Space between logo and title */
    }
    .header h1 {
        margin: 0;
        font-size: 1.8rem;
        font-weight: 700;
        z-index: 2; /* Ensure text is above semi-transparent background */
    }

    /* Logo Styling */
    .header .logo {
        height: 40px; /* Adjust logo height as needed */
        width: auto; /* Maintain aspect ratio */
        border-radius: 50%; /* Make it round if preferred */
        object-fit: cover; /* Ensure image covers the area */
        box-shadow: 0 0 0 3px rgba(255,255,255,0.5); /* White border around logo */
        z-index: 2; /* Ensure logo is above semi-transparent background */
    }

    .container {
      max-width: 600px;
      width: 90%;
      margin: 30px auto;
      background: var(--white-bg);
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 25px var(--shadow-medium);
      flex-grow: 1;
      box-sizing: border-box;
    }

    h2 {
      text-align: center;
      color: var(--primary-blue);
      font-size: 1.8rem;
      margin-bottom: 25px;
      font-weight: 700;
    }

    p {
      text-align: center;
      color: var(--text-color-light);
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text-color-dark);
    }

    input[type="text"],
    input[type="tel"],
    select { /* Now includes select for styling */
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 1rem;
      box-sizing: border-box;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    input[type="text"]:focus,
    input[type="tel"]:focus,
    select:focus { /* Added select for focus style */
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
      outline: none;
    }

    /* Styles for Phone number input with prefix */
    .phone-input-group {
      display: flex;
      align-items: center;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      overflow: hidden;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .phone-input-group:focus-within {
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
    }
    .phone-prefix {
      padding: 12px;
      background-color: var(--light-gray-bg);
      border-right: 1px solid var(--border-color);
      color: var(--text-color-dark);
      font-size: 1rem;
      white-space: nowrap;
    }
    .phone-input-group input[type="tel"] {
      flex-grow: 1;
      border: none;
      padding: 12px;
      border-radius: 0 6px 6px 0;
      width: auto;
    }

    button[type="submit"], .whatsapp-button {
      display: block;
      margin: 30px auto 0;
      width: fit-content;
      min-width: 180px;
      padding: 15px 30px;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      font-size: 1.1rem;
      transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
      text-decoration: none;
      text-align: center;
    }

    button[type="submit"] {
      background-color: var(--primary-blue);
      box-shadow: 0 4px 10px rgba(0, 123, 255, 0.2);
    }
    button[type="submit"]:hover {
      background-color: #0056b3;
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 123, 255, 0.3);
    }
    button[type="submit"]:active {
      transform: translateY(0);
      box-shadow: 0 2px 5px rgba(0, 123, 255, 0.2);
    }

    .whatsapp-button {
        background-color: var(--whatsapp-color);
        box-shadow: 0 4px 10px rgba(37, 211, 102, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        margin-top: 15px; /* Slightly less margin than main submit button */
    }
    .whatsapp-button:hover {
        background-color: var(--whatsapp-dark-color);
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(37, 211, 102, 0.3);
    }
    .whatsapp-button:active {
        transform: translateY(0);
        box-shadow: 0 2px 5px rgba(37, 211, 102, 0.2);
    }
    .whatsapp-icon {
        font-size: 1.3rem;
    }


    .success-message {
      background-color: var(--success-bg);
      color: var(--success-text);
      border: 1px solid var(--success-border);
      padding: 25px; /* More padding for a success page look */
      border-radius: 8px;
      text-align: center;
      margin-top: 20px;
      font-size: 1rem;
      font-weight: 500;
      display: none; /* Hidden by default */
    }
    .success-message p {
        margin-bottom: 15px;
        color: var(--success-text);
        font-weight: bold;
    }
    .success-message .whatsapp-button {
        margin-top: 20px; /* Adjust margin within success message */
    }

    .footer-love {
        text-align: center;
        font-size: 0.85rem;
        color: var(--text-color-light);
        margin-top: 30px;
        padding-bottom: 15px;
        width: 100%;
    }
    .footer-love a {
        color: var(--primary-blue);
        text-decoration: none;
        font-weight: 500;
    }
  </style>
</head>
<body>
  <!-- COVER PICTURE CONTAINER - Your cover image URL is now directly in the style tag above -->
  <div class="cover-picture-container">
    <!-- HEADER - Positioned over the cover image -->
    <div class="header">
        <!-- LOGO - Your logo image URL is now embedded -->
        <img src="https://ik.imagekit.io/bigquamsmedia/GeneratedImageOctober042025-8_07PM1_.jpeg?updatedAt=1759624474530" alt="CampusConnect NG Logo" class="logo"> 
        <h1>CampusConnect NG</h1>
    </div>
  </div>

  <div class="container">
    <h2>Join Our Campus Network!</h2>
    <p>Connect with fellow students across Nigeria. Fill out the form below to get started.</p>

    <form id="contact-form">
      <div class="form-group">
        <label for="name">Your Name:</label>
        <input type="text" id="name" name="name" placeholder="e.g., Danny, Bella" required>
      </div>

      <div class="form-group">
        <label for="state">Your State:</label>
        <select id="state" name="state" required>
            <option value="">-- Select State --</option>
            <!-- Nigerian States Options will be populated here by JavaScript -->
        </select>
      </div>

      <div class="form-group">
        <label for="phone">Phone Number:</label>
        <div class="phone-input-group">
            <span class="phone-prefix">🇳🇬 +234</span>
            <input type="tel" id="phone" name="phone" placeholder="e.g., 801 234 5678" required>
        </div>
      </div>

      <!-- This hidden field ensures all new submissions get 'New' for the membertype column -->
      <input type="hidden" name="membertype" value="New">

      <button type="submit">Submit My Details</button>
    </form>

    <!-- Success Message Container - now includes WhatsApp button -->
    <div id="success-message" class="success-message">
      <p>Fantastic! Your details have been submitted successfully. To get your VCF file and stay connected, join our WhatsApp group below!</p>
      <a href="https://chat.whatsapp.com/Hiu0e5OTvUIIk6Rq3ndsUA" target="_blank" class="whatsapp-button">
          <span class="whatsapp-icon">📱</span> Join Our WhatsApp Group
      </a>
    </div>

  </div>

  <div class="footer-love">
      Created with ❤️ by <a href="#" target="_blank">CampusConnect NG</a>
  </div>

  <script>
    const FORM_API_URL = "https://sheetdb.io/api/v1/203f2csgdcsp0"; // Your SheetDB URL for submissions
    const form = document.getElementById('contact-form');
    const successMessage = document.getElementById('success-message');
    const stateSelect = document.getElementById('state');

    const nigerianStates = [
      "Abia", "Adamawa", "Akwa Ibom", "Anambra", "FCT Abuja", "Bauchi", "Bayelsa", "Benue", "Borno", 
      "Cross River", "Delta", "Ebonyi", "Edo", "Ekiti", "Enugu", "Gombe", "Imo", "Jigawa", "Kaduna", 
      "Kano", "Katsina", "Kebbi", "Kogi", "Kwara", "Lagos", "Nasarawa", "Niger", "Ogun", "Ondo", 
      "Osun", "Oyo", "Plateau", "Rivers", "Sokoto", "Taraba", "Yobe", "Zamfara"
    ].sort(); // Sort alphabetically for better display

    // Populate states dropdown
    nigerianStates.forEach(state => {
        const option = document.createElement('option');
        option.value = state;
        option.textContent = state;
        stateSelect.appendChild(option);
    });

    // Function to normalize phone number
    function normalizePhoneNumber(inputNumber) {
        // 1. Remove all non-digit characters
        let cleanedNumber = inputNumber.replace(/\D/g, '');

        // 2. Handle common Nigerian prefixes
        if (cleanedNumber.startsWith('0')) {
            // Remove leading '0'
            cleanedNumber = cleanedNumber.substring(1);
        } else if (cleanedNumber.startsWith('234')) {
            // If already starts with 234, remove it to re-add later for consistency
            cleanedNumber = cleanedNumber.substring(3);
        } else if (cleanedNumber.startsWith('+234')) {
            // If already starts with +234, remove it to re-add later for consistency
            cleanedNumber = cleanedNumber.substring(4);
        }
        // At this point, cleanedNumber should be a 10-digit number like '8012345678'

        // 3. Validate length (expecting 10 digits after cleaning)
        if (cleanedNumber.length === 10) {
            return `+234${cleanedNumber}`;
        } else {
            // If it's not a standard 10-digit number, return null or throw an error
            // For now, we'll return the original cleaned number or a simple +234 prefix
            // It's crucial to decide how strict you want this to be.
            // For sending to backend, a normalized +234xxxxxxxxxx is best.
            // If it's not 10 digits, it's likely invalid for Nigeria after normalization.
            console.warn("Phone number length mismatch after normalization. Original:", inputNumber, "Cleaned:", cleanedNumber);
            // Optionally, you could make this an error and prevent submission.
            // For now, we'll try to prepend +234, but it might still be invalid.
            return `+234${cleanedNumber}`; 
        }
    }


    form.addEventListener('submit', function(e) {
      e.preventDefault(); // Prevent default form submission

      const formData = new FormData(form);
      const data = {};
      formData.forEach((value, key) => {
        data[key] = value;
      });

      // Normalize the phone number using the new function
      const rawPhoneNumber = data.phone;
      const normalizedPhoneNumber = normalizePhoneNumber(rawPhoneNumber);
      
      // Basic validation for normalization
      if (normalizedPhoneNumber && normalizedPhoneNumber.length === 14 && normalizedPhoneNumber.startsWith('+234')) {
          data.phone = normalizedPhoneNumber;
      } else {
          alert('Please enter a valid Nigerian phone number (e.g., 08012345678 or 8012345678).');
          return; // Stop form submission
      }

      // Log data for debugging (optional)
      console.log("Submitting data:", data);

      fetch(FORM_API_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ data: [data] }), // SheetDB expects an array of objects
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(result => {
        console.log('Success:', result);
        form.reset(); // Clear the form
        form.style.display = 'none'; // Hide the form
        successMessage.style.display = 'block'; // Show the success message
      })
      .catch(error => {
        console.error('Error!', error);
        alert('There was an error submitting your details. Please try again.'); // User feedback on error
      });
    });
  </script>
</body>
</html>
