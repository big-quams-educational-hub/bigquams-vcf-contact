<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CampusConnect NG - Join Us</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --primary-blue: #007BFF;
      --secondary-orange: #FF8C00;
      --tertiary-green: #28A745;
      --white-bg: #FFFFFF;
      --light-gray-bg: #F8F9FA;
      
      --text-color-dark: #212529;
      --text-color-light: #6C757D;
      --border-color: #CED4DA;
      
      --shadow-light: rgba(0,0,0,0.08);
      --shadow-medium: rgba(0,0,0,0.12);
      
      --success-bg: #D4EDDA;
      --success-border: #C3E6CB;
      --success-text: #155724;
      
      --whatsapp-link-color: var(--tertiary-green);
    }

    body {
      font-family: 'Segoe UI', 'Roboto', sans-serif;
      background: var(--light-gray-bg);
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      color: var(--text-color-dark);
      line-height: 1.6;
    }

    .header {
        width: 100%;
        background-color: var(--primary-blue);
        color: var(--white-bg);
        padding: 15px 0;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        margin-bottom: 30px;
    }
    .header h1 {
        margin: 0;
        font-size: 1.8rem;
        font-weight: 700;
    }

    .container {
      max-width: 600px;
      width: 90%;
      margin: 30px auto;
      background: var(--white-bg);
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 25px var(--shadow-medium);
      flex-grow: 1;
      box-sizing: border-box;
    }

    h2 {
      text-align: center;
      color: var(--primary-blue);
      font-size: 1.8rem;
      margin-bottom: 25px;
      font-weight: 700;
    }

    p {
      text-align: center;
      color: var(--text-color-light);
      margin-bottom: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text-color-dark);
    }

    input[type="text"],
    input[type="tel"] {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 1rem;
      box-sizing: border-box;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    input[type="text"]:focus,
    input[type="tel"]:focus {
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
      outline: none;
    }

    /* Styles for Phone number input with prefix */
    .phone-input-group {
      display: flex;
      align-items: center;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      overflow: hidden; /* Ensures border-radius applies to contents */
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    .phone-input-group:focus-within {
      border-color: var(--primary-blue);
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
    }
    .phone-prefix {
      padding: 12px;
      background-color: var(--light-gray-bg);
      border-right: 1px solid var(--border-color);
      color: var(--text-color-dark);
      font-size: 1rem;
      white-space: nowrap; /* Prevent wrapping */
    }
    .phone-input-group input[type="tel"] {
      flex-grow: 1; /* Allows the input to take remaining space */
      border: none; /* Remove individual input border */
      padding: 12px;
      border-radius: 0 6px 6px 0; /* Only right corners for input */
      width: auto; /* Override 100% width from general rule */
    }

    /* Styles for checkboxes */
    .state-checkbox-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 10px;
        padding: 10px 0;
        max-height: 250px; /* Limit height */
        overflow-y: auto; /* Add scroll if too many states */
        border: 1px solid var(--border-color);
        border-radius: 6px;
        background-color: var(--white-bg);
        padding: 15px;
    }
    .state-checkbox-group label {
        display: flex;
        align-items: center;
        margin-bottom: 0; /* Reset default label margin */
        font-weight: normal;
        cursor: pointer;
    }
    .state-checkbox-group input[type="checkbox"] {
        margin-right: 8px;
        width: 16px; /* Standard checkbox size */
        height: 16px;
        flex-shrink: 0; /* Prevent checkbox from shrinking */
    }


    button[type="submit"] {
      display: block;
      margin: 30px auto 0;
      width: fit-content;
      min-width: 180px;
      padding: 15px 30px;
      background-color: var(--primary-blue);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      font-size: 1.1rem;
      transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 123, 255, 0.2);
    }
    button[type="submit"]:hover {
      background-color: #0056b3;
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 123, 255, 0.3);
    }
    button[type="submit"]:active {
      transform: translateY(0);
      box-shadow: 0 2px 5px rgba(0, 123, 255, 0.2);
    }

    .success-message {
      background-color: var(--success-bg);
      color: var(--success-text);
      border: 1px solid var(--success-border);
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      margin-top: 20px;
      font-size: 1rem;
      font-weight: 500;
      display: none; /* Hidden by default */
    }

    .footer-love {
        text-align: center;
        font-size: 0.85rem;
        color: var(--text-color-light);
        margin-top: 30px;
        padding-bottom: 15px;
        width: 100%;
    }
    .footer-love a {
        color: var(--primary-blue);
        text-decoration: none;
        font-weight: 500;
    }
  </style>
</head>
<body>
  <div class="header">
      <h1>CampusConnect NG</h1>
  </div>

  <div class="container">
    <h2>Join Our Campus Network!</h2>
    <p>Connect with fellow students across Nigeria. Fill out the form below to get started.</p>

    <form id="contact-form">
      <div class="form-group">
        <label for="name">Your Name:</label>
        <input type="text" id="name" name="name" placeholder="e.g., Kemi, Broda Segun" required>
      </div>

      <div class="form-group">
        <label>Your State(s):</label>
        <div class="state-checkbox-group" id="state-checkboxes">
          <!-- Nigerian States Checkboxes will be populated here by JavaScript -->
        </div>
      </div>

      <div class="form-group">
        <label for="phone">Phone Number:</label>
        <div class="phone-input-group">
            <span class="phone-prefix">üá≥üá¨ +234</span>
            <input type="tel" id="phone" name="phone" placeholder="e.g., 801 234 5678" required>
        </div>
      </div>

      <!-- This hidden field ensures all new submissions get 'New' for the membertype column -->
      <input type="hidden" name="membertype" value="New">

      <button type="submit">Submit My Details</button>
    </form>

    <div id="success-message" class="success-message">
      Fantastic! Your details have been submitted successfully. Welcome to CampusConnect NG!
    </div>
  </div>

  <div class="footer-love">
      Created with ‚ù§Ô∏è by <a href="#" target="_blank">CampusConnect NG</a>
  </div>

  <script>
    const FORM_API_URL = "https://sheetdb.io/api/v1/203f2csgdcsp0"; // Your SheetDB URL for submissions
    const form = document.getElementById('contact-form');
    const successMessage = document.getElementById('success-message');
    const stateCheckboxesDiv = document.getElementById('state-checkboxes');

    const nigerianStates = [
      "Abia", "Adamawa", "Akwa Ibom", "Anambra", "Ad Abuja", "Bauchi", "Bayelsa", "Benue", "Borno", 
      "Cross River", "Delta", "Ebonyi", "Edo", "Ekiti", "Enugu", "Gombe", "Imo", "Jigawa", "Kaduna", 
      "Kano", "Katsina", "Kebbi", "Kogi", "Kwara", "Lagos", "Nasarawa", "Niger", "Ogun", "Ondo", 
      "Osun", "Oyo", "Plateau", "Rivers", "Sokoto", "Taraba", "Yobe", "Zamfara"
    ].sort(); // Sort alphabetically for better display

    // Populate states checkboxes
    nigerianStates.forEach(state => {
        const checkboxId = `state-${state.toLowerCase().replace(/\s/g, '-')}`;
        const checkboxHtml = `
            <input type="checkbox" id="${checkboxId}" name="states[]" value="${state}">
            <label for="${checkboxId}">${state}</label>
        `;
        const div = document.createElement('div');
        div.innerHTML = checkboxHtml;
        stateCheckboxesDiv.appendChild(div);
    });

    form.addEventListener('submit', function(e) {
      e.preventDefault(); // Prevent default form submission

      const formData = new FormData(form);
      const data = {};
      formData.forEach((value, key) => {
        data[key] = value;
      });

      // Special handling for states (combine selected states into a single string)
      const selectedStates = Array.from(document.querySelectorAll('input[name="states[]"]:checked'))
                                  .map(checkbox => checkbox.value);
      data.state = selectedStates.join(', '); // Join selected states with a comma
      if (selectedStates.length === 0) {
          alert('Please select at least one state.');
          return; // Stop submission if no state is selected
      }

      // Prepend +234 to the phone number if not already present
      let phoneNumber = data.phone.replace(/\s/g, ''); // Remove spaces
      if (!phoneNumber.startsWith('+234')) {
          phoneNumber = '+234' + phoneNumber;
      }
      data.phone = phoneNumber;

      const submitButton = form.querySelector('button[type="submit"]');
      submitButton.textContent = 'Submitting...';
      submitButton.disabled = true;

      fetch(FORM_API_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
      })
      .then(response => {
        if (!response.ok) { 
            return response.json().then(errorData => {
                throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
            }).catch(() => {
                throw new Error(`HTTP error! status: ${response.status}`);
            });
        }
        return response.json(); 
      })
      .then(result => {
        console.log('Success:', result);
        successMessage.style.display = 'block'; 
        form.reset(); // Clear the form
        // Uncheck all state checkboxes after form reset
        document.querySelectorAll('input[name="states[]"]:checked').forEach(checkbox => {
            checkbox.checked = false;
        });
        submitButton.textContent = 'Submit My Details'; 
        submitButton.disabled = false; 
        setTimeout(() => {
          successMessage.style.display = 'none';
        }, 5000); 
      })
      .catch((error) => {
        console.error('Error:', error);
        alert('There was an error submitting your details: ' + error.message + '. Please try again.');
        submitButton.textContent = 'Submit My Details'; 
        submitButton.disabled = false; 
      });
    });
  </script>

</body>
</html>
